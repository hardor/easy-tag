<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html [<!ENTITY nbsp "&#160;"> <!ENTITY times "&#215;"> <!ENTITY copy "&#211;">]>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core">
    <ui:composition template="/templates/main-template.xhtml">
        <ui:define name="content">
            <div class="span7">
                <div class="box paint color_7">
                    <div class="title">
                        <h4>
                            <i class="icon-book"></i>
                            <span>Edit Password</span>
                        </h4>
                    </div>
                    <div class="content">
                        <h:form id ="change_password_form" class="form-horizontal row-fluid">

                            <h:messages id="messages" title="Info" showDetail="true"/>

                            <div class="form-row control-group row-fluid">
                                <label class="control-label span3" for="password-field">Old Password</label>
                                <div class="controls span9">
                                    <h:inputSecret  class="row-fluid password"  value="#{changePasswordBean.oldPassword}"/>
                                </div>
                            </div>
                            <div class="form-row control-group row-fluid">
                                <label class="control-label span3" for="password-field">New Password</label>
                                <div class="controls span9">
                                    <h:inputSecret  class="row-fluid password"  value="#{changePasswordBean.newPassword}"/>
                                </div>
                            </div>
                            <div class="form-row control-group row-fluid">
                                <label class="control-label span3" for="password-field">Confirm Password</label>
                                <div class="controls span9">
                                    <h:inputSecret  class="row-fluid password"  value="#{changePasswordBean.confirmPassword}"/>
                                </div>
                            </div>

                            <div class="form-actions row-fluid">
                                <div class="span3 visible-desktop"></div>
                                <div class="span7 ">
                                    <h:commandLink type="submit" class="btn btn-primary" value="Save" actionListener="#{changePasswordBean.changePasswordAction(evt)}">
                                        <f:ajax render=":change_password_form" execute="@form"/>
                                    </h:commandLink>
                                    <h:link class="btn btn-primary" value="Cancel" outcome="/user/profile/index"/>
                                </div>                                
                            </div>
                        </h:form>

                    </div>
                    <a class="btn change_color_outside">
                        <i class="paint_bucket"></i>
                    </a>
                </div>

            </div>

            <!--password recovery-->
            <div class="span7">
                <div class="box paint color_7">
                    <div class="title">
                        <h4>
                            <i class="icon-book"></i>
                            <span>Recovery Password</span>
                        </h4>
                    </div>
                    <div class="content">
                        <h:form id="recovery_form" prependId="false"> 
                            <p><strong>Password Recovery Form</strong></p>
                            <h:messages id="recovery_messages" title="Info" showDetail="true"/>
                            <div class="form-row control-group row-fluid">
                                <td><label class="control-label span3" for="normal-field">Your email</label></td>
                                <td><h:inputText id="recovery_email" class="row-fluid" p:placeholder="newmail@mail.com" value="#{passwordRecoveryBean.login}"/></td> 
                            </div>
                            <div class="form-actions row-fluid">
                                <div>
                                    <h:commandLink  class="btn btn-primary"  value="Reset password!" actionListener="#{passwordRecoveryBean.recoverAction}">
                                        <f:ajax execute="@form" render="recovery_messages" onevent="handleRecover"/>
                                    </h:commandLink>
                                </div>
                            </div>
                            <h:inputHidden id="recovery_status" value="#{passwordRecoveryBean.recoveryStatus}"/>
                        </h:form>
                    </div>
                    <a class="btn change_color_outside">
                        <i class="paint_bucket"></i>
                    </a>
                </div>

            </div>
        </ui:define>
    </ui:composition>
</html>
